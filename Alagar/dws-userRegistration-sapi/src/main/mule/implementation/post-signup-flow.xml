<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
	<sub-flow name="post-signup-flowSub_Flow" doc:id="6c779af6-67c7-4240-936d-6a562952bd36" >
    <logger level="INFO" doc:name="Log - Before Insert DB Call"
        message="*** Starting DB INSERT into Signup | Timestamp: #[now() as String {format:'yyyy-MM-dd HH:mm:ss.SSS'}] | CorrelationId: #[correlationId] ***" />
		<until-successful maxRetries="${untilSuccessful.maxRetries}" doc:name="Until Successful" doc:id="0975461f-2153-4b61-a565-d51232108c2d" millisBetweenRetries="${untilSuccessful.retriesTime}">
			<try doc:name="Try" doc:id="f4a4046e-e7e5-4ca9-84dc-48a28dc632b7">
			<db:insert doc:name="Insert Database" doc:id="f68298df-1731-4b2c-99fd-01b4c8bc7261" config-ref="Database_Config">
			<db:sql><![CDATA[${database.insert_signup}]]></db:sql>
					<db:input-parameters ><![CDATA[#[{
employeeid:payload.employeeID, 
name: payload.name, 
email:payload.email,
phonenumber: payload.phoneNumber, 
password: payload.password,
company: payload.company
}]]]></db:input-parameters>
		</db:insert>
			<error-handler ref="global-db-error-handler" />
		</try>
		</until-successful>
		<logger level="INFO" doc:name="Log - After Insert DB Call"
        message="*** Successfully INSERTED record into Signup | Timestamp: #[now() as String {format:'yyyy-MM-dd HH:mm:ss.SSS'}] | CorrelationId: #[correlationId] ***" />
	
	</sub-flow>
</mule>
