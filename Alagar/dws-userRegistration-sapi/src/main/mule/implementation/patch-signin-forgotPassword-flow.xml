<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
	<sub-flow name="patch-signin-forgotPassword-flowSub_Flow" doc:id="b7b348f5-41e3-452a-8947-ab4535a406b8" >
   <logger level="INFO" doc:name="Log - Before Forgot Password Upsert DB Call"
        message="*** Initiating Forgot Password UPSERT on Signup table | Timestamp: #[now() as String {format:'yyyy-MM-dd HH:mm:ss.SSS'}] | CorrelationId: #[correlationId] ***" />
		<until-successful maxRetries="${untilSuccessful.maxRetries}" doc:name="Until Successful" doc:id="15bebaec-22ce-4b42-8f67-c9bee8348450" millisBetweenRetries="${untilSuccessful.retriesTime}">
			<try doc:name="Try" doc:id="2350ec80-1c59-4917-aa51-0b24dab404e9">
			<db:update doc:name="Patch Database" doc:id="a5f3a51c-2513-4245-8f52-0c11b057ffa0" config-ref="Database_Config">
			<db:sql><![CDATA[${database.patch_signup}]]></db:sql>
					<db:input-parameters ><![CDATA[#[{
email:payload.email,
phonenumber: payload.phoneNumber, 
password: payload.password
}]]]></db:input-parameters>
		</db:update>
			<error-handler ref="global-db-error-handler" />
		</try>
		</until-successful>
		<logger level="INFO" doc:name="Log - After Forgot Password Upsert DB Call"
        message="*** Completed Forgot Password UPSERT on Signup table | Timestamp: #[now() as String {format:'yyyy-MM-dd HH:mm:ss.SSS'}] | CorrelationId: #[correlationId] ***" />
	</sub-flow>
</mule>
