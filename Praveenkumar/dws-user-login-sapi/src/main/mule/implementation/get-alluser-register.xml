<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
	<sub-flow name="get-alluser-flow" doc:id="b9e02537-8c2a-4bd3-832c-0e968aaf5ab3" >
		<logger level="INFO" doc:name="Start Fetch All Registered Users" doc:id="c6e43a33-a193-4383-8d15-a7e2a6ead8b3" message="*** Received request to fetch all registered employee details | CorrelationId: #[correlationId] ***" />
		<until-successful maxRetries="${untilSuccess.maxRetries}" doc:name="Until Successful" doc:id="f6b48169-5704-4bee-8242-6b2c5a3028d8" millisBetweenRetries="${untilSuccess.retriesTime}">
			<db:select doc:id="e64eec84-ebff-449c-accf-3f77207146ce" config-ref="Database_Config" doc:name="Select All Registered User Details">
			<db:sql><![CDATA[${database_query.getAllRegisteredUser}]]></db:sql>
		</db:select>
		</until-successful>
		<logger level="INFO" doc:name="End Fetch All Registered Users" doc:id="d995e352-1f6e-41e4-b6e3-dbe59b7267aa" message="*** Successfully fetched  all the registered employee records: #[sizeOf(payload)] | CorrelationId: #[correlationId] ***" />
	</sub-flow>
	<sub-flow name="get-userByEmailId-flow" doc:id="cb588aaa-07c0-486f-a732-357b405f6262" >
		<logger level="INFO" doc:name="Start Fetch All Registered Users" doc:id="31f9edf4-0d95-42c8-8daa-e9f95754d727" message="*** Received request to fetch a single registered employee details | CorrelationId: #[correlationId] ***" />
		<set-variable value="#[%dw 2.0&#10;output application/java&#10;---&#10;p('database_query.getUser')  ++ &quot;'&quot; ++ vars.vEmail ++ &quot;'&quot;]" doc:name="vQuery Variable" doc:id="4ed7a7f3-1bff-4a29-abfe-0d18c2675074" variableName="vQuery"/>
		<until-successful maxRetries="${untilSuccess.maxRetries}" doc:name="Until Successful" doc:id="cc4cb64f-7e20-4115-a753-d775aa057920" millisBetweenRetries="${untilSuccess.retriesTime}" >
			<db:select doc:id="12681e06-9a26-4df9-807d-42bff1c12011" config-ref="Database_Config" doc:name="Select All Registered User Details">
			<db:sql><![CDATA[#[vars.vQuery]]]></db:sql>
		</db:select>
		</until-successful>
		<logger level="INFO" doc:name="End Fetch All Registered Users" doc:id="0d384cc3-ca2e-45cb-afee-991049aae12a" message="*** Successfully fetched the single registered employee records: #[payload.employeeId] | CorrelationId: #[correlationId] ***" />
	</sub-flow>
</mule>
